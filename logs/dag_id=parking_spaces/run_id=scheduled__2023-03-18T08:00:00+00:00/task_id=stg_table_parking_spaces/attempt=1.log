[2023-03-18T09:00:08.612+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: parking_spaces.stg_table_parking_spaces scheduled__2023-03-18T08:00:00+00:00 [queued]>
[2023-03-18T09:00:08.631+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: parking_spaces.stg_table_parking_spaces scheduled__2023-03-18T08:00:00+00:00 [queued]>
[2023-03-18T09:00:08.632+0000] {taskinstance.py:1279} INFO - 
--------------------------------------------------------------------------------
[2023-03-18T09:00:08.632+0000] {taskinstance.py:1280} INFO - Starting attempt 1 of 1
[2023-03-18T09:00:08.632+0000] {taskinstance.py:1281} INFO - 
--------------------------------------------------------------------------------
[2023-03-18T09:00:08.648+0000] {taskinstance.py:1300} INFO - Executing <Task(MySqlOperator): stg_table_parking_spaces> on 2023-03-18 08:00:00+00:00
[2023-03-18T09:00:08.653+0000] {standard_task_runner.py:55} INFO - Started process 60433 to run task
[2023-03-18T09:00:08.660+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'parking_spaces', 'stg_table_parking_spaces', 'scheduled__2023-03-18T08:00:00+00:00', '--job-id', '551', '--raw', '--subdir', 'DAGS_FOLDER/parking_spaces.py', '--cfg-path', '/tmp/tmpwvwq1avq']
[2023-03-18T09:00:08.663+0000] {standard_task_runner.py:83} INFO - Job 551: Subtask stg_table_parking_spaces
[2023-03-18T09:00:08.778+0000] {task_command.py:388} INFO - Running <TaskInstance: parking_spaces.stg_table_parking_spaces scheduled__2023-03-18T08:00:00+00:00 [running]> on host diploma-vm.europe-west1-b.c.diploma-380314.internal
[2023-03-18T09:00:08.882+0000] {taskinstance.py:1507} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=parking_spaces
AIRFLOW_CTX_TASK_ID=stg_table_parking_spaces
AIRFLOW_CTX_EXECUTION_DATE=2023-03-18T08:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-03-18T08:00:00+00:00
[2023-03-18T09:00:08.883+0000] {sql.py:254} INFO - Executing: INSERT IGNORE INTO stg_parking_spaces
(
SELECT
    CONCAT(`space_id`, '_', `name`, '_', `available_spots_last_updated`) AS `parking_space_id`,
    `space_id`,
    `name`,
    `source`,
    `postal_code`,
    `address_region`,
    `street_address`,
    `address_country`,
    `address_locality`,
    `address_formatted`,
    `category`,
    `type`,
    `coordinates`,
    `valid_to`,
    `source_id`,
    `tariff_id`,
    `zone_type`,
    `valid_from`,
    `area_served`,
    `parking_type`,
    `data_provider`,
    `date_modified`,
    `total_spot_number`,
    `ios_app_payment_url`,
    `web_app_payment_url`,
    `available_spots_number`,
    `android_app_payment_url`,
    `available_spots_last_updated`,
    `_sys_record_id`,
    `_sys_load_id`,
    `_sys_load_at`,
    `_sys_is_deleted`,
    `i`
FROM (
    SELECT
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.id')) AS `space_id`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.name')) AS `name`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.source')) AS `source`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.address.postal_code')) AS `postal_code`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.address.address_region')) AS `address_region`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.address.street_address')) AS `street_address`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.address.address_country')) AS `address_country`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.address.address_locality')) AS `address_locality`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.address.address_formatted')) AS `address_formatted`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.category')) AS `category`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.centroid.type')) AS `type`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.centroid.coordinates')) AS `coordinates`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.valid_to')) AS `valid_to`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.source_id')) AS `source_id`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.tariff_id')) AS `tariff_id`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.zone_type')) AS `zone_type`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.valid_from')) AS `valid_from`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.area_served')) AS `area_served`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.parking_type')) AS `parking_type`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.data_provider')) AS `data_provider`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.date_modified')) AS `date_modified`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.total_spot_number')) AS `total_spot_number`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.ios_app_payment_url')) AS `ios_app_payment_url`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.web_app_payment_url')) AS `web_app_payment_url`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.available_spots_number')) AS `available_spots_number`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.android_app_payment_url')) AS `android_app_payment_url`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.available_spots_last_updated')) AS `available_spots_last_updated`,
        `_sys_record_id`,
        `_sys_load_id`,
        `_sys_load_at`,
        `_sys_is_deleted`,
        `i`
    FROM src_parking_spaces
    ) a
);
[2023-03-18T09:00:08.901+0000] {base.py:73} INFO - Using connection ID 'mysql-db' for task execution.
[2023-03-18T09:00:09.000+0000] {base.py:73} INFO - Using connection ID 'mysql-db' for task execution.
[2023-03-18T09:00:09.015+0000] {sql.py:375} INFO - Running statement: INSERT IGNORE INTO stg_parking_spaces
(
SELECT
    CONCAT(`space_id`, '_', `name`, '_', `available_spots_last_updated`) AS `parking_space_id`,
    `space_id`,
    `name`,
    `source`,
    `postal_code`,
    `address_region`,
    `street_address`,
    `address_country`,
    `address_locality`,
    `address_formatted`,
    `category`,
    `type`,
    `coordinates`,
    `valid_to`,
    `source_id`,
    `tariff_id`,
    `zone_type`,
    `valid_from`,
    `area_served`,
    `parking_type`,
    `data_provider`,
    `date_modified`,
    `total_spot_number`,
    `ios_app_payment_url`,
    `web_app_payment_url`,
    `available_spots_number`,
    `android_app_payment_url`,
    `available_spots_last_updated`,
    `_sys_record_id`,
    `_sys_load_id`,
    `_sys_load_at`,
    `_sys_is_deleted`,
    `i`
FROM (
    SELECT
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.id')) AS `space_id`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.name')) AS `name`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.source')) AS `source`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.address.postal_code')) AS `postal_code`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.address.address_region')) AS `address_region`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.address.street_address')) AS `street_address`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.address.address_country')) AS `address_country`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.address.address_locality')) AS `address_locality`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.address.address_formatted')) AS `address_formatted`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.category')) AS `category`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.centroid.type')) AS `type`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.centroid.coordinates')) AS `coordinates`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.valid_to')) AS `valid_to`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.source_id')) AS `source_id`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.tariff_id')) AS `tariff_id`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.zone_type')) AS `zone_type`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.valid_from')) AS `valid_from`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.area_served')) AS `area_served`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.parking_type')) AS `parking_type`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.data_provider')) AS `data_provider`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.date_modified')) AS `date_modified`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.total_spot_number')) AS `total_spot_number`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.ios_app_payment_url')) AS `ios_app_payment_url`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.web_app_payment_url')) AS `web_app_payment_url`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.available_spots_number')) AS `available_spots_number`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.android_app_payment_url')) AS `android_app_payment_url`,
        TRIM(BOTH '"' FROM JSON_EXTRACT(`jdoc`, '$.properties.available_spots_last_updated')) AS `available_spots_last_updated`,
        `_sys_record_id`,
        `_sys_load_id`,
        `_sys_load_at`,
        `_sys_is_deleted`,
        `i`
    FROM src_parking_spaces
    ) a
);, parameters: None
[2023-03-18T09:00:09.018+0000] {sql.py:384} INFO - Rows affected: 0
[2023-03-18T09:00:09.037+0000] {taskinstance.py:1318} INFO - Marking task as SUCCESS. dag_id=parking_spaces, task_id=stg_table_parking_spaces, execution_date=20230318T080000, start_date=20230318T090008, end_date=20230318T090009
[2023-03-18T09:00:09.073+0000] {local_task_job.py:208} INFO - Task exited with return code 0
[2023-03-18T09:00:09.101+0000] {taskinstance.py:2578} INFO - 0 downstream tasks scheduled from follow-on schedule check
